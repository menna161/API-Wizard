
import pandas as pd
df = pd.read_csv('data.csv')
print(df.head())
df_headers = pd.read_csv('data.csv', header=None)
print(df_headers.head())
column_labels_list = column_labels.split(',')
df.columns = column_labels_list
df_dropped = df.drop(list_to_drop, axis='columns')
print(df_dropped.head())
df_dropped['date'] = df_dropped['date'].astype(str)
df_dropped['Time'] = df_dropped['Time'].apply((lambda x: '{:0>4}'.format(x)))
date_string = (df_dropped['date'] + df_dropped['Time'])
date_times = pd.to_datetime(date_string, format='%Y%m%d%H%M')
df_clean = df_dropped.set_index(date_times)
print(df_clean.head())
print(df_clean.loc[('2011-6-20 8:00:00':'2011-6-20 9:00:00', 'dry_bulb_faren')])
df_clean['dry_bulb_faren'] = pd.to_numeric(df_clean['dry_bulb_faren'], errors='coerce')
print(df_clean.loc[('2011-6-20 8:00:00':'2011-6-20 9:00:00', 'dry_bulb_faren')])
df_clean['wind_speed'] = pd.to_numeric(df_clean['wind_speed'], errors='coerce')
df_clean['dew_point_faren'] = pd.to_numeric(df_clean['dew_point_faren'], errors='coerce')
print(df_clean['dry_bulb_faren'].median())
print(df_clean.loc[('2011-Apr':'2011-Jun', 'dry_bulb_faren')].median())
print(df_clean.loc[('2011-Jan', 'dry_bulb_faren')].median())
daily_mean_2011 = df_clean.resample('D').mean()
daily_temp_2011 = daily_mean_2011['dry_bulb_faren'].values
daily_climate = df_climate.resample('D').mean()
daily_temp_climate = daily_climate.reset_index()['Temperature']
difference = (daily_temp_2011 - daily_temp_climate)
print(difference.mean())
sunny = df_clean.loc[(df_clean['sky_condition'] == 'CLR')]
overcast = df_clean.loc[df_clean['sky_condition'].str.contains('OVC')]
sunny_daily_max = sunny.resample('D').max()
overcast_daily_max = overcast.resample('D').max()
print((sunny_daily_max.mean() - overcast_daily_max.mean()))
import matplotlib.pyplot as plt
weekly_mean = df_clean[['visibility', 'dry_bulb_faren']].resample('W').mean()
print(weekly_mean.corr())
weekly_mean.plot(subplots=True)
plt.show()
sunny = (df_clean['sky_condition'] == 'CLR')
sunny_hours = sunny.resample('D').sum()
total_hours = sunny.resample('D').count()
sunny_fraction = (sunny_hours / total_hours)
sunny_fraction.plot(kind='box')
plt.show()
monthly_max = df_clean[['dew_point_faren', 'dry_bulb_faren']].resample('M').max()
monthly_max.plot(kind='hist', bins=8, alpha=0.5, subplots=True)
plt.show()
august_max = df_climate.loc[('2010-Aug', 'Temperature')].max()
print(august_max)
august_2011 = df_clean.loc[('2011-Aug', 'dry_bulb_faren')].resample('D').max()
august_2011_high = august_2011.loc[(august_2011 > august_max)]
august_2011_high.plot(kind='hist', normed=True, cumulative=True, bins=25)
plt.show()
